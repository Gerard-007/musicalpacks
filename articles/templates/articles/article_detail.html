{% extends "layout.html" %}
{% load widget_tweaks %}
{% load staticfiles %}
{% load blog_tag %}

{% block title %}article_detail{% endblock title %}


{% block content %}
<!--Main layout-->
    <main class="mt-5 pt-5">
        <div class="container-fluid">

            <!--Section: article-->
            <section class="mt-4">


              <!-- <div class="view">
                  <img src="https://mdbootstrap.com/img/Photos/Others/forest-sm.jpg" class="img-fluid" alt="placeholder">
                  <div class="mask flex-center waves-effect waves-light rgba-teal-strong">
                      <p class="white-text">strong overlay</p>
                  </div>
              </div> -->

                <!--Grid row-->
                <div class="row">

                    <!--Grid column-->
                    <div class="col-md-8 mb-4">

                        <!--Featured Image-->
                        <div class="card mb-4 wow fadeIn">
                            <img src="{{article.get_img_url.url}}" class="img-fluid" alt="{{article.title}}">
                        </div>
                        <!--/.Featured Image-->


                        <!--Card-->
                        <div class="card mb-4 wow fadeIn">
                            <!--Card content-->
                            <div class="card-body">
                                <p class="h5 my-4">{{ article.title }}</p>
                                <p>{{ article.content|safe|linebreaks }}</p>
                            </div>
                        </div>
                        <!--/.Card-->

                        <!--Card-->
                        <div class="card mb-4 wow fadeIn">
                            <div class="card-header font-weight-bold">
                                <span>About Author</span>
                                <span class="pull-right">
                                    <a href="#" target="_blank">
                                        <i class="fa fa-facebook mr-2"></i>
                                    </a>
                                    <a href="#" target="_blank">
                                        <i class="fa fa-twitter mr-2"></i>
                                    </a>
                                    <a href="#" target="_blank">
                                        <i class="fa fa-instagram mr-2"></i>
                                    </a>
                                    <a href="#" target="_blank">
                                        <i class="fa fa-linkedin mr-2"></i>
                                    </a>
                                </span>
                            </div>

                            <!--Card content-->
                            <div class="card-body">
                                <div class="media d-block d-md-flex mt-3">
                                    <img class="d-flex rounded-circle avatar z-depth-1-half mb-3 mx-auto" src="https://mdbootstrap.com/img/Others/documentation/img (20)-mini.jpg" alt="Avatar">
                                    <div class="media-body text-center text-md-left ml-md-3 ml-0">
                                        <h5 class="mt-0 font-weight-bold">{{article.author}}</h5>
                                        Write somthing about your self here...
                                    </div>
                                </div>
                            </div><!-- card-body -->

                        </div>
                        <!--/.Card-->


                        <!--Comments-->
                        <div class="card card-comments mb-3 wow fadeIn">
                            {% with comments.count as total_comments %}
                                {% if total_comments == 0 %}
                                    <div class="card-header font-weight-bold">No comments yet, be the first to comment this article!.</div>
                                {% else %}
                                    <div class="card-header font-weight-bold">{{ total_comments }} Comment{{ total_comments|pluralize }}</div>
                                {%endif%}
                            {% endwith %}
                            <div class="card-body">
                              <!-- displays available comments for this article -->
                              {% for comment in comments %}
                              <div class="media d-block d-md-flex">
                                  <img class="d-flex rounded-circle avatar z-depth-1-half mb-3 mx-auto" src="https://mdbootstrap.com/img/Others/documentation/img (2)-mini.jpg" alt="Avatar">
                                  <div class="media-body text-center text-md-left ml-md-3 ml-0">
                                      <h5 class="mt-0 font-weight-bold blue-text">comment {{ forloop.counter }} by {{ comment.author }} {{ comment.created }}</h5>
                                      {{ comment.content|markdown }}
                                  </div>
                              </div>
                              {% endfor %}

                              </div>

                            </div>
                            <!--/.Comments-->

                            <!-- Displays comment form for registered users else link visitors to registeration page -->

                            {% if user.is_authenticated %}

                                {% if new_comment %}
                                    <h4><span class="badge badge-pill green">your comment has been added <i class="fa fa-check" aria-hidden="true"></i></span></h4>
                                {% else %}
                                    <form method="POST" action="" class="card-body form">
                                      {% csrf_token %}
                                      {{ comment_form.non_field_errors }}
                                      {{ comment_form.source.errors }}
                                      {{ comment_form.source }}
                                      <!-- Default textarea -->
                                      <div class="md-form">
                                        {% render_field comment_form.content id="text2" class="md-textarea md-textarea-auto form-control" rows="1" %}
                                        {{ comment_form.content.errors }}
                                          <label for="text2">{{comment_form.content.label}}</label>
                                      </div>
                                      <button type="submit" class="btn btn-primary btn-md">
                                        <i class="fa fa-send"> comment</i>
                                      </button>

                                    </form>
                                {% endif %}

                            {% else %}
                                <h4>You have to register inorder to comment this article  <span class="badge badge-pill blue">Register<i class="fa fa-user-plus" aria-hidden="true"></i></span></h4>
                            {% endif %}

                    </div>
                    <!--Grid column-->



                    <!--Grid column-->
                    <div class="col-md-4 mb-4">

                        <!--Card : Dynamic content wrapper-->
                        <div class="card mb-4 text-center wow fadeIn">

                            <div class="card-header">Register get informed about new articles?</div>

                            <!--Card content-->
                            <div class="card-body">
                              <!-- Material form subscription -->
                              <form method="POST" action="" class="card-body form">
                                {% csrf_token %}
                                  <p class="h4 text-center mb-4">Subscribe</p>

                                  <!-- Material input text -->
                                  <div class="md-form">
                                      {% render_field nl_form.name type="text" id="materialFormSubscriptionNameEx" class="form-control" %}
                                      <label for="materialFormSubscriptionNameEx">{{nl_form.name.label}}</label>
                                  </div>

                                  <!-- Material input email -->
                                  <div class="md-form">
                                      {% render_field nl_form.email type="email" id="materialFormSubscriptionEmailEx" class="form-control" %}
                                      <label for="materialFormSubscriptionNameEx">{{nl_form.email.label}}</label>
                                  </div>

                                  <div class="text-center mt-4">
                                      <button class="btn btn-info btn-md" type="submit">Register</button>
                                  </div>
                              </form>
                              <!-- Material form subscription -->

                            </div>

                        </div>
                        <!--/.Card : Dynamic content wrapper-->

                        <!--Card-->
                        <div class="card mb-4 wow fadeIn">

                            <div class="card-header">Similar articles</div>

                            <!--Card content-->
                            <div class="card-body">

                                <ul class="list-unstyled">
                                   {% for article in similar_articles %}
                                    <li class="media">
                                      <img class="d-flex mr-3"
                                       src="{{article.get_img_url.url}}" alt="{{article.title}}">
                                      <div class="media-body">
                                          <a href="{{ article.get_absolut_url }}">
                                              <h5 class="mt-0 mb-1 font-weight-bold">{{article.title}}</h5>
                                          </a>
                                          {{article.content|safe|truncatewords:10}}
                                      </div>
                                      {% empty %}
                                      There are no similar articles yet
                                    </li>
                                    <hr width="30%">
                                    {% endfor %}
                                </ul>

                            </div>

                        </div>
                        <!--/.Card-->

                    </div>
                    <!--Grid column-->


                </div>
                <!--Grid row-->

            </section>
            <!--Section: article-->

        </div>
    </main>
    <!--Main layout-->

{% endblock content %}
